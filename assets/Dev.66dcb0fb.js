import{d as m,x as i,c as r,a as h,r as o,F as p,m as g,b as f,e as x,f as u,g as b,_ as y,o as T,h as v}from"./index.149d9425.js";const _=t=>r(o("xIcon"),{icon:t,style:"width:16px;height:100%;",class:"auto-size"},null),A=m({name:"xMenuTree",props:["tree","authFn"],setup(){return{}},data(t){return t.setActiveMenuHighlight=i.debounce(function(){const a=t.pathAndIdCollection[t.currentPath];!a||(t.onOpenChange([a]),t.arr_selectedMenuId=[a])},300),{openKeys:[],pathAndIdCollection:{},arr_selectedMenuId:[]}},watch:{currentPath:{immediate:!0,handler(){this.setActiveMenuHighlight&&this.setActiveMenuHighlight()}}},methods:{onOpenChange(t){if(!i.isArrayFill(t))return;const a=i.last(t)||"",l=i.safeSplit(a,"###").filter(n=>n),e=[];for(let n=0;n<l.length;n++){const s=l[n];n===0?e[0]=`###${s}`:e[n]=`${e[n-1]}###${s}`}this.openKeys=e}},computed:{currentPath(){return this.$route.path},subTree(){const t=this,a=this.tree||[],l=(e,n)=>{const s=`${n}###${e.id}`;return this.authFn&&!this.authFn(e)?null:i.isArrayFill(e.children)?r(o("aSubMenu"),{key:s},{icon:()=>_(e.icon),title:()=>e.label,default:()=>i.map(e.children,d=>l(d,s))}):(t.pathAndIdCollection[e.path]=s,r(o("aMenuItem"),{key:s,class:"flex middle"},{icon:()=>_(e.icon),title:()=>e.label,default:()=>{if(e.payload&&e.payload.openType&&e.payload.openType==="NEW_TAB"){const d={};return e.path||(d.disabled=!0),r("a",g({title:e.label},d,{href:e.path,target:"_blank",onClick:c=>{c.stopPropagation(),c.preventDefault(),!!e.path&&e.path&&window.open(e.path,"_blank")}}),[e.label])}return r(p,null,[r(o("RouterLink"),{to:e.path||"/404"},{default:()=>[e.label]})])}}))};return i.isArrayFill(a)?i.map(a,e=>l(e,"")):null}},render(){return r(p,null,[this.currentPath,this.openKeys,h("arr_selectedMenuId:"),this.arr_selectedMenuId,h("pathAndIdCollection: "),JSON.stringify(this.pathAndIdCollection),r(o("aMenu"),{openKeys:this.openKeys,onOpenChange:this.onOpenChange,selectedKeys:this.arr_selectedMenuId,"onUpdate:selectedKeys":t=>this.arr_selectedMenuId=t,mode:"inline"},{default:()=>[this.subTree]})])}}),C=m({components:{xMenuTree:A},data(t){return{treeArray:[{id:"a",label:"a",icon:"vite",path:"/Dev/a"},{id:"b",label:"b",icon:"vite",children:[{id:"ba",label:"a",icon:"vite",path:"/Dev/b/a"},{id:"bb",label:"b",icon:"UserOutlined",path:"/Dev/b/b"},{id:"bc",label:"c",icon:"UserOutlined",children:[{id:"a",label:"a",icon:"vite",path:"/Dev/b/c/a"},{id:"b",label:"b",icon:"vite",path:"/Dev/b/c/b"}]}]}],configs_xVirTable:f({rowHeight:32,dataSource:[],dataSourceFilter(a){return i.map(a,l=>(l.configsName=x.item({value:l.name}),l))},columns:{...u({prop:"name",label:t.$t("\u540D\u79F0").label,renderCell:({record:a})=>b('<xItem :configs="record.configsName"/>',{record:a})}),...u({label:t.$t("\u64CD\u4F5C").label,prop:"operations",width:"40px",renderHeader:()=>null,renderCell:({record:a})=>b('<a @click="del(record.id)">del</a>',{record:a,del:t.del})})}})}},mounted(){this.genNewData()},methods:{setTableValue(t,a,l){const e=i.findIndex(this.configs_xVirTable.dataSource,{id:t});if(~e){const n=this.configs_xVirTable.dataSource.splice(e,1);n[a]=l,this.configs_xVirTable.dataSource.splice(e,0,n)}},updateDateSource(){i.each(this.configs_xVirTable.dataSource,t=>{t.name=t.configsName.value})},del(t){const a=i.findIndex(this.configs_xVirTable.dataSource,{id:t});~a&&(this.updateDateSource(),this.configs_xVirTable.dataSource.splice(a,1))},add(){this.updateDateSource(),this.configs_xVirTable.dataSource.unshift({id:i.genId("id"),name:"name"})},genNewData:i.debounce(function(){this.configs_xVirTable.dataSource=[...new Array(2)].map((t,a)=>({id:i.genId("id"),name:"name"+a}))},10)}});function S(t,a,l,e,n,s){const d=o("xMenuTree");return T(),v(d,{tree:t.treeArray},null,8,["tree"])}const V=y(C,[["render",S],["__scopeId","data-v-59580aa4"]]);export{V as default};
