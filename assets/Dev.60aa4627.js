import{d as m,x as i,c as r,r as d,F as p,m as _,a as g,b as f,e as h,f as u,_ as x,o as y,g as T}from"./index.cb26f74c.js";const b=t=>r(d("xIcon"),{icon:t,style:"width:16px;height:100%;",class:"auto-size"},null),v=m({name:"xMenuTree",props:["tree","authFn"],setup(){return{}},data(t){return t.setActiveMenuHighlight=i.debounce(function(){const a=t.pathAndIdCollection[t.currentPath];!a||(t.onOpenChange([a]),t.arr_selectedMenuId=[a])},300),{openKeys:[],pathAndIdCollection:{},arr_selectedMenuId:[]}},watch:{currentPath:{immediate:!0,handler(){this.setActiveMenuHighlight&&this.setActiveMenuHighlight()}}},methods:{onOpenChange(t){if(!i.isArrayFill(t))return;const a=i.last(t)||"",n=i.safeSplit(a,"###").filter(l=>l),e=[];for(let l=0;l<n.length;l++){const s=n[l];l===0?e[0]=`###${s}`:e[l]=`${e[l-1]}###${s}`}this.openKeys=e}},computed:{currentPath(){return this.$route.path},subTree(){const t=this,a=this.tree||[],n=(e,l)=>{const s=`${l}###${e.id}`;return this.authFn&&!this.authFn(e)?null:i.isArrayFill(e.children)?r(d("aSubMenu"),{key:s},{icon:()=>b(e.icon),title:()=>e.label,default:()=>i.map(e.children,o=>n(o,s))}):(t.pathAndIdCollection[e.path]=s,r(d("aMenuItem"),{key:s,class:"flex middle"},{icon:()=>b(e.icon),title:()=>e.label,default:()=>{if(e.payload&&e.payload.openType&&e.payload.openType==="NEW_TAB"){const o={};return e.path||(o.disabled=!0),r("a",_({title:e.label},o,{href:e.path,target:"_blank",onClick:c=>{c.stopPropagation(),c.preventDefault(),!!e.path&&e.path&&window.open(e.path,"_blank")}}),[e.label])}return r(p,null,[r(d("RouterLink"),{to:e.path||"/404"},{default:()=>[e.label]})])}}))};return i.isArrayFill(a)?i.map(a,e=>n(e,"")):null}},render(){return r(p,null,[r(d("aMenu"),{openKeys:this.openKeys,onOpenChange:this.onOpenChange,selectedKeys:this.arr_selectedMenuId,"onUpdate:selectedKeys":t=>this.arr_selectedMenuId=t,mode:"inline"},{default:()=>[this.subTree]})])}}),A=m({components:{xMenuTree:v},data(t){return{treeArray:[{id:"a",label:"a",icon:"vite",path:"/Dev/a"},{id:"b",label:"b",icon:"vite",children:[{id:"ba",label:"a",icon:"vite",path:"/Dev/b/a"},{id:"bb",label:"b",icon:"UserOutlined",path:"/Dev/b/b"},{id:"bc",label:"c",icon:"UserOutlined",children:[{id:"a",label:"a",icon:"vite",path:"/Dev/b/c/a"},{id:"b",label:"b",icon:"vite",path:"/Dev/b/c/b"}]}]}],configs_xVirTable:g({rowHeight:32,dataSource:[],dataSourceFilter(a){return i.map(a,n=>(n.configsName=f.item({value:n.name}),n))},columns:{...h({prop:"name",label:t.$t("\u540D\u79F0").label,renderCell:({record:a})=>u('<xItem :configs="record.configsName"/>',{record:a})}),...h({label:t.$t("\u64CD\u4F5C").label,prop:"operations",width:"40px",renderHeader:()=>null,renderCell:({record:a})=>u('<a @click="del(record.id)">del</a>',{record:a,del:t.del})})}})}},mounted(){this.genNewData()},methods:{setTableValue(t,a,n){const e=i.findIndex(this.configs_xVirTable.dataSource,{id:t});if(~e){const l=this.configs_xVirTable.dataSource.splice(e,1);l[a]=n,this.configs_xVirTable.dataSource.splice(e,0,l)}},updateDateSource(){i.each(this.configs_xVirTable.dataSource,t=>{t.name=t.configsName.value})},del(t){const a=i.findIndex(this.configs_xVirTable.dataSource,{id:t});~a&&(this.updateDateSource(),this.configs_xVirTable.dataSource.splice(a,1))},add(){this.updateDateSource(),this.configs_xVirTable.dataSource.unshift({id:i.genId("id"),name:"name"})},genNewData:i.debounce(function(){this.configs_xVirTable.dataSource=[...new Array(2)].map((t,a)=>({id:i.genId("id"),name:"name"+a}))},10)}});function S(t,a,n,e,l,s){const o=d("xMenuTree");return y(),T(o,{tree:t.treeArray},null,8,["tree"])}const D=x(A,[["render",S],["__scopeId","data-v-59580aa4"]]);export{D as default};
